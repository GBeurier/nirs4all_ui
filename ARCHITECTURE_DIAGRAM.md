# nirs4all Pipeline Format Integration - Architecture

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        NIRS4ALL ECOSYSTEM                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Python Library â”‚                           â”‚   UI Frontend   â”‚  â”‚
â”‚  â”‚   (nirs4all)    â”‚                           â”‚    (React)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                                              â”‚           â”‚
â”‚           â”‚ Serialization                   Visual Tree â”‚           â”‚
â”‚           â”‚    (.json)                      Representation           â”‚
â”‚           â–¼                                              â–¼           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Pipeline Format â”‚â—„â”€â”€â”€â”€â”€â”€â”€ Converter â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   TreeNodes     â”‚  â”‚
â”‚  â”‚                 â”‚                           â”‚                 â”‚  â”‚
â”‚  â”‚ [                â”‚                           â”‚ nodes: [        â”‚  â”‚
â”‚  â”‚   {class: ...}  â”‚                           â”‚   {id, label,   â”‚  â”‚
â”‚  â”‚   {model: ...}  â”‚                           â”‚    componentId, â”‚  â”‚
â”‚  â”‚   {_or_: ...}   â”‚                           â”‚    params,      â”‚  â”‚
â”‚  â”‚ ]               â”‚                           â”‚    children}]   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                                              â”‚           â”‚
â”‚           â”‚                                              â”‚           â”‚
â”‚           â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚           â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Backend API    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                      â”‚ (FastAPI)      â”‚                             â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         UI Pipeline Editor                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Component Lib   â”‚  â”‚  Pipeline Canvas â”‚  â”‚  Config Panel    â”‚   â”‚
â”‚  â”‚  (component-     â”‚  â”‚  (TreeView)      â”‚  â”‚  (Parameters)    â”‚   â”‚
â”‚  â”‚   library.json)  â”‚  â”‚                  â”‚  â”‚                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                     â”‚                      â”‚              â”‚
â”‚           â”‚                     â”‚                      â”‚              â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                      â”‚                     â”‚                          â”‚
â”‚                      â–¼                     â–¼                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚         â”‚         nirs4allConverter.ts               â”‚               â”‚
â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚               â”‚
â”‚         â”‚  â”‚  loadNirs4allPipeline()              â”‚  â”‚               â”‚
â”‚         â”‚  â”‚  - Parse JSON/object                 â”‚  â”‚               â”‚
â”‚         â”‚  â”‚  - Map classes â†’ component IDs       â”‚  â”‚               â”‚
â”‚         â”‚  â”‚  - Handle generators, models         â”‚  â”‚               â”‚
â”‚         â”‚  â”‚  - Create TreeNode hierarchy         â”‚  â”‚               â”‚
â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚               â”‚
â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚               â”‚
â”‚         â”‚  â”‚  exportNirs4allPipeline()            â”‚  â”‚               â”‚
â”‚         â”‚  â”‚  - Convert TreeNodes â†’ steps         â”‚  â”‚               â”‚
â”‚         â”‚  â”‚  - Map component IDs â†’ classes       â”‚  â”‚               â”‚
â”‚         â”‚  â”‚  - Reconstruct models, containers    â”‚  â”‚               â”‚
â”‚         â”‚  â”‚  - Format as JSON                    â”‚  â”‚               â”‚
â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow

### Loading Pipeline (JSON â†’ UI)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JSON File   â”‚
â”‚  or API     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Read JSON
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ loadNirs4allPipeline(data)      â”‚
â”‚                                  â”‚
â”‚ Step 1: Parse structure          â”‚
â”‚   â”œâ”€ Array?                      â”‚
â”‚   â”œâ”€ Object with .pipeline?      â”‚
â”‚   â””â”€ Object with .steps?         â”‚
â”‚                                  â”‚
â”‚ Step 2: Convert each element     â”‚
â”‚   â”œâ”€ Class node?                 â”‚
â”‚   â”œâ”€ Model node?                 â”‚
â”‚   â”œâ”€ Generator node?             â”‚
â”‚   â”œâ”€ Container node?             â”‚
â”‚   â””â”€ Viz node?                   â”‚
â”‚                                  â”‚
â”‚ Step 3: Map class â†’ componentId  â”‚
â”‚   "sklearn...MinMaxScaler"       â”‚
â”‚   â””â”€> "minmax_scaler"            â”‚
â”‚                                  â”‚
â”‚ Step 4: Build TreeNode structure â”‚
â”‚   {                              â”‚
â”‚     id: "abc123",                â”‚
â”‚     label: "MinMax Scaler",      â”‚
â”‚     componentId: "minmax_scaler",â”‚
â”‚     params: {...},               â”‚
â”‚     children: [...]              â”‚
â”‚   }                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ 2. TreeNode[]
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ React State: setNodes(nodes)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ 3. Render
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Visual Pipeline Editor          â”‚
â”‚  ğŸ”§ MinMax Scaler               â”‚
â”‚  ğŸ“¦ Y Processing                â”‚
â”‚    â””â”€ MinMax Scaler             â”‚
â”‚  ğŸ“¦ Feature Augmentation        â”‚
â”‚    â”œâ”€ Detrend                   â”‚
â”‚    â””â”€ First Derivative          â”‚
â”‚  ğŸ¤– PLS-5 (n_components: 5)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Saving Pipeline (UI â†’ JSON)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Visual Pipeline Editor          â”‚
â”‚  [User edits components]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ 1. TreeNode[]
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ exportNirs4allPipeline(nodes)   â”‚
â”‚                                  â”‚
â”‚ Step 1: Iterate TreeNodes        â”‚
â”‚                                  â”‚
â”‚ Step 2: Convert each node        â”‚
â”‚   â”œâ”€ Generator? â†’ {_or_: ...}   â”‚
â”‚   â”œâ”€ Model? â†’ {name, model}     â”‚
â”‚   â”œâ”€ Container? â†’ {key: [...]}  â”‚
â”‚   â””â”€ Regular? â†’ {class, params} â”‚
â”‚                                  â”‚
â”‚ Step 3: Map componentId â†’ class  â”‚
â”‚   "minmax_scaler"                â”‚
â”‚   â””â”€> "sklearn...MinMaxScaler"  â”‚
â”‚                                  â”‚
â”‚ Step 4: Format as JSON           â”‚
â”‚   [                              â”‚
â”‚     {"class": "sklearn..."},     â”‚
â”‚     {"model": {...}},            â”‚
â”‚     ...                          â”‚
â”‚   ]                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ 2. JSON string
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Download / Save / API Send      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Class Mapping System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CLASS_TO_COMPONENT_ID (Load)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Python Class Path                    UI Component ID     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  sklearn.preprocessing...MinMaxScaler â†’ minmax_scaler     â”‚
â”‚  nirs4all.operators...Detrend         â†’ detrend           â”‚
â”‚  sklearn.cross_decomp...PLSRegression â†’ pls_regression    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              COMPONENT_ID_TO_CLASS (Save)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  UI Component ID                      Python Class Path   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  minmax_scaler         â†’ sklearn.preprocessing...MinMax   â”‚
â”‚  detrend               â†’ nirs4all.operators...Detrend     â”‚
â”‚  pls_regression        â†’ sklearn.cross_decomp...PLSReg    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Node Type Handling

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Node Types                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  1. REGULAR (transformations, scalers)                     â”‚
â”‚     JSON: {"class": "...", "params": {...}}                â”‚
â”‚     Tree: {componentId, params, nodeType: "regular"}       â”‚
â”‚                                                            â”‚
â”‚  2. MODEL (ML models with training config)                 â”‚
â”‚     JSON: {"name": "...", "model": {...}}                  â”‚
â”‚     Tree: {componentId, params: {model_name, ...}}         â”‚
â”‚                                                            â”‚
â”‚  3. CONTAINER (workflow nodes with children)               â”‚
â”‚     JSON: {"feature_augmentation": [...]}                  â”‚
â”‚     Tree: {componentId, children: [...]}                   â”‚
â”‚                                                            â”‚
â”‚  4. GENERATION (generators for combinations)               â”‚
â”‚     JSON: {"_or_": [...], "size": 2}                       â”‚
â”‚     Tree: {componentId: "_or_", children: [...]}           â”‚
â”‚                                                            â”‚
â”‚  5. VISUALIZATION (charts, plots)                          â”‚
â”‚     JSON: "chart_2d"                                       â”‚
â”‚     Tree: {componentId: "chart_2d"}                        â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Generator Expansion

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Generator Nodes                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  IN UI:                                                     â”‚
â”‚  âš™ï¸ OR Generator                                            â”‚
â”‚     â””â”€ Detrend                                              â”‚
â”‚     â””â”€ FirstDerivative                                      â”‚
â”‚     â””â”€ Gaussian                                             â”‚
â”‚     size: 2                                                 â”‚
â”‚                                                             â”‚
â”‚  IN JSON:                                                   â”‚
â”‚  {                                                          â”‚
â”‚    "_or_": ["Detrend", "FirstDerivative", "Gaussian"],      â”‚
â”‚    "size": 2                                                â”‚
â”‚  }                                                          â”‚
â”‚                                                             â”‚
â”‚  AT RUNTIME (Backend):                                      â”‚
â”‚  Pipeline 1: [Detrend, FirstDerivative]                     â”‚
â”‚  Pipeline 2: [Detrend, Gaussian]                            â”‚
â”‚  Pipeline 3: [FirstDerivative, Gaussian]                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Range Generator                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  IN UI:                                                     â”‚
â”‚  âš™ï¸ Range Generator                                         â”‚
â”‚     â””â”€ PLS Regression                                       â”‚
â”‚     range: [1, 10, 2]                                       â”‚
â”‚     param: n_components                                     â”‚
â”‚                                                             â”‚
â”‚  IN JSON:                                                   â”‚
â”‚  {                                                          â”‚
â”‚    "_range_": [1, 10, 2],                                   â”‚
â”‚    "param": "n_components",                                 â”‚
â”‚    "model": {"class": "PLSRegression"}                      â”‚
â”‚  }                                                          â”‚
â”‚                                                             â”‚
â”‚  AT RUNTIME (Backend):                                      â”‚
â”‚  Model 1: PLSRegression(n_components=1)                     â”‚
â”‚  Model 2: PLSRegression(n_components=3)                     â”‚
â”‚  Model 3: PLSRegression(n_components=5)                     â”‚
â”‚  Model 4: PLSRegression(n_components=7)                     â”‚
â”‚  Model 5: PLSRegression(n_components=9)                     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## File Structure

```
nirs4all_ui/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ nirs4allConverter.ts â”€â”€â”€â”€â”€â”€â”€â–º Main converter logic
â”‚   â”‚   â””â”€â”€ nirs4allConverter.test.ts â”€â”€â–º Test utilities
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â””â”€â”€ PipelinePage.tsx â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Uses converter
â”‚   â””â”€â”€ components/
â”‚       â””â”€â”€ pipeline/
â”‚           â””â”€â”€ *.tsx â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º UI components
â”œâ”€â”€ public/
â”‚   â””â”€â”€ component-library.json â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Component definitions
â”œâ”€â”€ NIRS4ALL_FORMAT.md â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Full format docs
â”œâ”€â”€ NIRS4ALL_INTEGRATION_SUMMARY.md â”€â”€â”€â”€â–º Implementation summary
â”œâ”€â”€ QUICK_START_NIRS4ALL.md â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Quick start guide
â””â”€â”€ demo-converter.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Demo script
```

## Integration Points

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Integration Points                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. Load Modal                                              â”‚
â”‚     User uploads JSON â†’ loadNirs4allPipeline() â†’ setNodes() â”‚
â”‚                                                             â”‚
â”‚  2. Session Storage                                         â”‚
â”‚     Prediction page â†’ stores JSON â†’ loads in PipelinePage   â”‚
â”‚                                                             â”‚
â”‚  3. URL Parameters                                          â”‚
â”‚     ?prediction_id=X â†’ fetch pipeline â†’ load â†’ display      â”‚
â”‚                                                             â”‚
â”‚  4. Export Button                                           â”‚
â”‚     Click â†’ exportNirs4allPipeline() â†’ download JSON        â”‚
â”‚                                                             â”‚
â”‚  5. Save Button                                             â”‚
â”‚     Click â†’ file dialog â†’ exportNirs4allPipeline() â†’ save   â”‚
â”‚                                                             â”‚
â”‚  6. Run Button                                              â”‚
â”‚     Click â†’ treeNodesToNirs4all() â†’ API request â†’ execute   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Future Enhancements

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Possible Enhancements                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  âœ¨ Generator Preview                                       â”‚
â”‚     Show sample expanded pipelines before running           â”‚
â”‚                                                             â”‚
â”‚  âœ… Pipeline Validation                                     â”‚
â”‚     Check for errors before save/run                        â”‚
â”‚                                                             â”‚
â”‚  ğŸ“š Template Library                                        â”‚
â”‚     Pre-built pipeline templates for common tasks           â”‚
â”‚                                                             â”‚
â”‚  ğŸ Python Code Import                                      â”‚
â”‚     Parse Python files directly                             â”‚
â”‚                                                             â”‚
â”‚  ğŸ” Component Search                                        â”‚
â”‚     Search/filter components by name or type                â”‚
â”‚                                                             â”‚
â”‚  ğŸ“Š Generation Statistics                                   â”‚
â”‚     Show how many configs will be generated                 â”‚
â”‚                                                             â”‚
â”‚  ğŸ¨ Visual Generator Builder                                â”‚
â”‚     Drag-and-drop interface for generator config            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
